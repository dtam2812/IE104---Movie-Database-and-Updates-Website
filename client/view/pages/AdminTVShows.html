<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="admin.tvshows.title">Admin TV Shows Management</title>
    <link
      rel="icon"
      type="image/png"
      href="../../../public/assets/image/logo-web-black.png"
    />
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../../Services/reset.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link rel="stylesheet" href="../../Style/HeaderAndFooter.css" />
    <link rel="stylesheet" href="../../Style/AdminPage.css" />
  </head>

  <body>
    <!-- start-header -->
    <div id="header"></div>

    <script type="module">
      import { headerjs } from "../../js/Header.js";
      import { searchBar } from "../../js/SearchBar.js";
      import { initTranslate } from "../../js/Translate.js";
      import { AdminTVShows_js } from "../../js/AdminTVShows.js";

      // Load header & search bar
      fetch("../components/Header.html")
        .then((res) => res.text())
        .then((html) => {
          document.getElementById("header").innerHTML = html;
          headerjs();
          return fetch("../components/SearchBar.html");
        })
        .then((res) => res.text())
        .then((searchHTML) => {
          document.querySelector(".search-box").innerHTML = searchHTML;
          searchBar();
          // Initialize translation after DOM is ready
          return initTranslate();
        })
        .then(() => {
          // Initialize AdminTVShows after translation
          AdminTVShows_js();
        })
        .catch((error) => console.error("Initialization failed:", error));
    </script>

    <!-- end-header -->

    <!-- Main Section -->
    <section class="main">
      <!-- Sidebar -->
      <div class="admin-menu-container">
        <nav class="admin-menu">
          <ul class="admin-menu-list">
            <li>
              <a href="../pages/AdminUsers.html">
                <i class="fa-solid fa-user"></i>
                <span data-i18n="admin.users">Users</span>
              </a>
            </li>
            <li>
              <a href="../pages/AdminMovies.html">
                <i class="fa-solid fa-film"></i>
                <span data-i18n="admin.movies">Movies</span>
              </a>
            </li>
            <li>
              <a class="active" href="#">
                <i class="fa-solid fa-tv"></i>
                <span data-i18n="admin.tvshows">TV Shows</span>
              </a>
            </li>
            <li>
              <a href="../pages/HomePage.html">
                <i class="fa-solid fa-right-from-bracket"></i>
                <span data-i18n="admin.signout">Sign Out</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>

      <!-- Main Content -->
      <div class="admin-main-container">
        <div class="admin-main-content">
          <div class="am-content-heading">
            <h1 data-i18n="admin.tvshows.heading">TV Shows</h1>
            <a class="add-btn">
              <i class="fa-solid fa-plus"></i>
              <span data-i18n="admin.tvshows.modal.add">Add TV Show</span>
            </a>
          </div>

          <!-- Search and Filter -->
          <div class="am-search-box">
            <div class="search-bar">
              <div class="search-icon">
                <i class="fa-solid fa-magnifying-glass"></i>
              </div>
              <input
                class="search-input"
                data-i18n-placeholder="admin.tvshows.search"
                placeholder="Search by TV show name or ID (e.g. TV001)"
                autocomplete="off"
              />
            </div>
            <div class="filter-bar">
              <select class="filter-select">
                <option value="all" data-i18n="admin.movies.allCountry">All Country</option>
                <option value="America" data-i18n="admin.movies.country.america">America</option>
                <option value="Japan" data-i18n="admin.movies.country.japan">Japan</option>
                <option value="Korea" data-i18n="admin.movies.country.korea">Korea</option>
                <option value="China" data-i18n="admin.movies.country.china">China</option>
                <option value="England" data-i18n="admin.movies.country.england">England</option>
              </select>
              <select class="filter-select">
                <option value="all" data-i18n="admin.movies.allStatus">All Status</option>
                <option value="Released" data-i18n="admin.movies.status.released">Released</option>
                <option value="Coming Soon" data-i18n="admin.movies.status.comingSoon">Coming Soon</option>
              </select>
              <select class="filter-select">
                <option value="all" data-i18n="admin.movies.allRating">All Rating</option>
                <option value="9+">9.0+</option>
                <option value="8+">8.0+</option>
                <option value="7+">7.0+</option>
                <option value="6+">6.0+</option>
                <option value="5+">5.0+</option>
              </select>
            </div>
          </div>

          <!-- Table -->
          <div class="dm-table-container">
            <div class="dm-table-heading">
              <h2>
                <span data-i18n="admin.tvshows.count">TV Shows</span> (0)
              </h2>
            </div>
            <table class="dm-table">
              <thead>
                <tr>
                  <th data-i18n="admin.movies.table.no">No.</th>
                  <th data-i18n="admin.movies.table.poster">Poster</th>
                  <th data-i18n="admin.movies.table.genre">Genre</th>
                  <th data-i18n="admin.tvshows.table.seasons">Seasons</th>
                  <th data-i18n="admin.movies.table.rating">Rating</th>
                  <th data-i18n="admin.movies.table.status">Status</th>
                  <th data-i18n="admin.movies.table.edit">Edit</th>
                  <th data-i18n="admin.movies.table.detail">Detail</th>
                  <th></th>
                </tr>
              </thead>
              <tbody class="dm-table-body"></tbody>
            </table>
          </div>

          <!-- Pagination -->
          <div class="content__pagination">
            <button class="pagination-left-arrow disable">
              <i class="fa-solid fa-arrow-left"></i>
            </button>
            <div class="pagination__main">
              <span class="pagination-page-current">1</span>
              <span>/ 0</span>
            </div>
            <button class="pagination-right-arrow">
              <i class="fa-solid fa-arrow-right"></i>
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal: Add/Edit TV Show -->
    <div class="modal-tvshow hidden">
      <div class="modal_backdrop"></div>
      <div class="modal_container">
        <div class="modal_dialog modal_dialog_centered modal_dialog--wide">
          <div class="modal_content">
            <button class="btn modal_close" aria-label="close">
              <i class="fa-solid fa-xmark"></i>
            </button>
            <div class="form-wrapper tvshow-form">
              <div class="content_header mb2">
                <h1 class="modal-title" data-i18n="admin.tvshows.modal.add">Add TV Show</h1>
              </div>

              <div class="content_body">
                <form class="v-form">
                  <!-- Hidden ID field -->
                  <input type="hidden" name="id" />

                  <!-- SECTION 1: Title + Overview + Banner + Poster -->
                  <div class="movie-section-top">
                    <!-- Left: Title + Overview -->
                    <div class="movie-info-left">
                      <div class="form-group mb2">
                        <label>
                          <span data-i18n="admin.movies.modal.title">Title:</span>
                          <span style="color: red" data-i18n="admin.required">*</span>
                        </label>
                        <input
                          class="form-control"
                          type="text"
                          name="title"
                          data-i18n-placeholder="admin.tvshows.modal.titlePlaceholder"
                          placeholder="TV Show title"
                          required
                        />
                      </div>

                      <div class="form-group mb2">
                        <label>
                          <span data-i18n="admin.movies.modal.overview">Overview:</span>
                          <span style="color: red" data-i18n="admin.required">*</span>
                        </label>
                        <textarea
                          class="form-control form-textarea"
                          name="overview"
                          data-i18n-placeholder="admin.tvshows.modal.overviewPlaceholder"
                          placeholder="TV Show overview/description"
                          rows="8"
                          required
                        ></textarea>
                      </div>
                    </div>

                    <!-- Right: Banner + Poster -->
                    <div class="tvshow-media-right movie-media-right">
                      <div class="banner-preview mb2">
                        <label>
                          <span data-i18n="admin.movies.modal.banner">Banner (16:9):</span>
                          <span style="color: red" data-i18n="admin.required">*</span>
                        </label>
                        <img src="" alt="Banner" />
                        <input
                          type="file"
                          class="banner-input"
                          name="banner"
                          accept="image/*"
                        />
                        <small data-i18n="admin.movies.modal.bannerRatio">Ratio: 16:9 (e.g. 1920x1080)</small>
                      </div>
                      <div class="poster-preview">
                        <label>
                          <span data-i18n="admin.movies.modal.poster">Poster (2:3):</span>
                          <span style="color: red" data-i18n="admin.required">*</span>
                        </label>
                        <img src="" alt="Poster" />
                        <input
                          type="file"
                          class="poster-input"
                          name="poster"
                          accept="image/*"
                        />
                        <small data-i18n="admin.movies.modal.posterRatio">Ratio: 2:3 (e.g. 600x900)</small>
                      </div>
                    </div>
                  </div>

                  <!-- SECTION 2: Các thông tin còn lại (2 cột) -->
                  <div class="movie-section-bottom">
                    <!-- Column 1 -->
                    <div class="movie-info-column">
                      <!-- Hiển thị ID khi Edit (readonly) -->
                      <div
                        class="form-group mb1 tvshow-id-display"
                        style="display: none"
                      >
                        <label>
                          <span data-i18n="admin.tvshows.modal.tvshowId">TV Show ID:</span>
                        </label>
                        <input
                          class="form-control"
                          type="text"
                          name="id-display"
                          data-i18n-placeholder="admin.movies.modal.autoGenerated"
                          placeholder="Auto-generated"
                          readonly
                        />
                      </div>

                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.movies.modal.genre">Genre:</span>
                          <span style="color: red" data-i18n="admin.required">*</span>
                        </label>
                        <input
                          class="form-control"
                          type="text"
                          name="genre"
                          data-i18n-placeholder="admin.movies.modal.genrePlaceholder"
                          placeholder="e.g. Comedy, Drama"
                          required
                        />
                      </div>

                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.tvshows.modal.seasons">Number of Seasons:</span>
                        </label>
                        <input
                          class="form-control"
                          type="number"
                          name="seasons"
                          data-i18n-placeholder="admin.movies.modal.autoGenerated"
                          placeholder="Auto-calculated"
                          readonly
                        />
                        <button
                          type="button"
                          class="btn btn-secondary manage-seasons-btn"
                          style="margin-top: 0.5rem; width: 100%"
                        >
                          <i class="fa-solid fa-list"></i>
                          <span data-i18n="admin.tvshows.modal.manageSeasons">Manage Seasons</span>
                        </button>
                      </div>

                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.tvshows.modal.totalEpisodes">Total Episodes:</span>
                        </label>
                        <input
                          class="form-control"
                          type="number"
                          name="totalEpisodes"
                          data-i18n-placeholder="admin.movies.modal.autoGenerated"
                          placeholder="Auto-calculated"
                          readonly
                        />
                      </div>

                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.movies.modal.country">Country:</span>
                          <span style="color: red" data-i18n="admin.required">*</span>
                        </label>
                        <input
                          class="form-control"
                          type="text"
                          name="country"
                          list="country-list"
                          data-i18n-placeholder="admin.movies.modal.countryPlaceholder"
                          placeholder="Type or select"
                          required
                        />
                        <datalist id="country-list">
                          <option value="America"></option>
                          <option value="Japan"></option>
                          <option value="Korea"></option>
                          <option value="China"></option>
                          <option value="England"></option>
                          <option value="France"></option>
                          <option value="Germany"></option>
                          <option value="Spain"></option>
                          <option value="Vietnam"></option>
                        </datalist>
                      </div>

                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.tvshows.modal.creator">Creator:</span>
                        </label>
                        <input
                          class="form-control"
                          type="text"
                          name="creator"
                          data-i18n-placeholder="admin.tvshows.modal.creatorPlaceholder"
                          placeholder="Creator name"
                        />
                      </div>

                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.tvshows.modal.actors">Main Cast:</span>
                        </label>
                        <input
                          class="form-control"
                          type="text"
                          name="actors"
                          data-i18n-placeholder="admin.tvshows.modal.actorsPlaceholder"
                          placeholder="Actor1, Actor2"
                        />
                      </div>
                    </div>

                    <!-- Column 2 -->
                    <div class="movie-info-column">
                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.movies.modal.producer">Producer:</span>
                        </label>
                        <input
                          class="form-control"
                          type="text"
                          name="producer"
                          data-i18n-placeholder="admin.movies.modal.producerPlaceholder"
                          placeholder="Producer name"
                        />
                      </div>

                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.movies.modal.budget">Budget (USD):</span>
                        </label>
                        <input
                          class="form-control"
                          type="number"
                          name="budget"
                          data-i18n-placeholder="admin.movies.modal.budgetPlaceholder"
                          placeholder="e.g. 50000000"
                        />
                      </div>

                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.movies.modal.revenue">Revenue (USD):</span>
                        </label>
                        <input
                          class="form-control"
                          type="number"
                          name="revenue"
                          data-i18n-placeholder="admin.movies.modal.revenuePlaceholder"
                          placeholder="e.g. 150000000"
                        />
                      </div>

                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.movies.modal.trailer">YouTube Trailer Link:</span>
                        </label>
                        <input
                          class="form-control"
                          type="url"
                          name="trailer"
                          data-i18n-placeholder="admin.movies.modal.trailerPlaceholder"
                          placeholder="e.g. https://www.youtube.com/watch?v=dQw4w9WgXcQ"
                        />
                      </div>

                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.movies.modal.rating">IMDb Rating:</span>
                        </label>
                        <input
                          class="form-control"
                          type="number"
                          name="rating"
                          data-i18n-placeholder="admin.movies.modal.ratingPlaceholder"
                          placeholder="e.g. 8.5"
                          step="0.1"
                          min="0"
                          max="10"
                        />
                      </div>

                      <div class="form-group mb1">
                        <label>
                          <span data-i18n="admin.movies.modal.status">Status:</span>
                          <span style="color: red" data-i18n="admin.required">*</span>
                        </label>
                        <select class="form-control" name="status" required>
                          <option value="Released" data-i18n="admin.movies.status.released">Released</option>
                          <option value="Coming Soon" data-i18n="admin.movies.status.comingSoon">Coming Soon</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <!-- Submit Button -->
                  <div class="form-group action-btn-center mt3 mb3">
                    <button 
                      type="submit" 
                      class="btn btn-primary"
                      data-i18n="admin.movies.modal.create"
                    >Create</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sub-Modal: Manage Seasons -->
    <div class="sub-modal-backdrop hidden" id="seasons-backdrop"></div>
    <div class="sub-modal hidden" id="seasons-sub-modal">
      <div class="sub-modal-header">
        <h3 data-i18n="admin.tvshows.submodal.title">Manage Seasons</h3>
        <button class="sub-close" type="button">×</button>
      </div>
      <div class="sub-modal-body">
        <button
          type="button"
          class="btn btn-primary add-season-btn"
          style="width: 100%; margin-bottom: 1rem"
        >
          <i class="fa-solid fa-plus"></i>
          <span data-i18n="admin.tvshows.submodal.addSeason">Add New Season</span>
        </button>
        <div id="seasons-list" class="seasons-accordion">
          <!-- JS sẽ render seasons ở đây -->
        </div>
      </div>
      <div class="sub-modal-footer">
        <button 
          type="button" 
          class="btn btn-primary save-seasons-btn"
          data-i18n="admin.tvshows.submodal.saveSeasons"
        >Save Seasons</button>
      </div>
    </div>

    <!-- start-footer -->
    <div id="footer"></div>

    <script type="module">
      fetch("../components/Footer.html")
        .then((res) => res.text())
        .then((html) => {
          document.getElementById("footer").innerHTML = html;
        })
        .catch((error) => {
          console.error("Fetch footer failed:", error);
        });
    </script>
    <!-- end-footer -->
  </body>
</html>